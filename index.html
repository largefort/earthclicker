<html><head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>EarthClicker</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
  <link href="disable.css" rel="stylesheet">
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4695170235902689" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.9.1/gsap.min.js"></script>
  <script src="cloudsaving.js"></script>
  <script src="greenworks.js"></script>
  <style>
    body,html {
background:linear-gradient(135deg,#1a1a2e 0%,#16213e 100%);
color:#e0e0e0;
margin:0;
padding:0;
width:100%;
height:100%;
overflow:hidden;
font-family:'Roboto',sans-serif
}

#game-container {
position:relative;
width:100%;
height:calc(100% - 70px);
transform:translateZ(0);
backface-visibility:hidden;
perspective:1000px
}

#mobile-nav {
position:fixed;
bottom:0;
left:0;
right:0;
height:70px;
background:linear-gradient(to top,#1a1a2ef2,#16213ef2);
backdrop-filter:blur(10px);
border-top:1px solid #ffffff1a;
box-shadow:0 -2px 10px #00000080;
display:flex;
justify-content:space-around;
align-items:center;
z-index:1000;
padding:0 10px;
transform:translateZ(0)
}

.nav-btn {
background:#ffffff0d;
border:1px solid #ffffff1a;
color:#fff;
font-size:15px;
padding:12px 20px;
border-radius:25px;
transition:all .3s cubic-bezier(0.4,0,0.2,1);
cursor:pointer;
outline:none
}

.nav-btn:hover {
background:#ffffff1a;
transform:translateY(-2px)
}

.nav-btn.active {
background:linear-gradient(45deg,#4a90e2,#67b26f);
border:none;
color:#fff;
box-shadow:0 4px 15px #4a90e24d
}

#tab-content {
height:100%
}

.tab-pane {
display:none;
height:100%;
overflow-y:auto;
transition:opacity .3s ease;
opacity:0
}

.tab-pane.active {
display:block;
opacity:1
}

#hud {
position:absolute;
top:10px;
left:50%;
transform:translateX(-50%);
width:auto;
max-width:80%;
margin:0;
padding:20px;
background:#ffffff0d;
backdrop-filter:blur(10px);
border:1px solid #ffffff1a;
border-radius:20px;
box-shadow:0 8px 32px #0000001a;
text-align:center
}

#upgrades,#sidebar,#stats-container {
background-color:#4a4a8ae6;
border-radius:10px;
margin:10px;
padding:15px;
max-width:600px;
margin-left:auto;
margin-right:auto
}

.upgrade-btn,.game-btn {
margin:5px;
padding:15px;
background:linear-gradient(45deg,#4a90e21a,#67b26f1a);
border:1px solid #ffffff1a;
border-radius:15px;
transition:all .3s cubic-bezier(0.4,0,0.2,1);
color:#fff;
cursor:pointer;
box-shadow:0 4px 6px #0000001a;
display:flex;
flex-direction:column;
justify-content:center;
align-items:center;
height:100%
}

.upgrade-btn:hover,.game-btn:hover {
background:linear-gradient(45deg,#4a90e233,#67b26f33);
transform:translateY(-3px);
box-shadow:0 8px 20px #0003
}

#upgrade-grid {
display:grid;
grid-template-columns:repeat(auto-fill,minmax(140px,1fr));
gap:10px;
padding-bottom:70px
}

#game-controls {
display:grid;
grid-template-columns:repeat(auto-fit,minmax(150px,1fr));
gap:10px;
padding-bottom:70px
}

#life-counter {
font-size:32px;
font-weight:700;
background:linear-gradient(45deg,#4a90e2,#67b26f);
-webkit-background-clip:text;
-webkit-text-fill-color:transparent;
text-shadow:none
}

#humans-counter,#animals-counter,#lps-counter {
font-size:16px;
margin-bottom:4px;
color:#0cf
}

#time-counter {
font-size:14px;
margin-top:8px;
color:#ffd700
}

.click-text {
position:absolute;
font-size:20px;
color:#0f0;
pointer-events:none;
z-index:1000;
will-change:transform,opacity
}

.life-particle {
position:absolute;
width:20px;
height:20px;
background-color:#0f0;
border-radius:50%;
pointer-events:none;
z-index:1000;
box-shadow:0 0 10px #00ff00,0 0 20px #0f0;
will-change:transform,opacity
}

#offline-progress-notification {
position:fixed;
bottom:70px;
left:50%;
transform:translateX(-50%);
background-color:#4a4a8ae6;
color:#fff;
padding:15px;
border-radius:10px;
text-align:center;
z-index:1001;
box-shadow:0 -2px 10px #0000004d
}

#offline-progress-notification p {
margin:5px 0
}

@media (max-width: 768px) {
#game-container {
height:calc(100% - 60px)
}

#hud {
max-width:90%;
padding:10px;
margin:10px
}

#life-counter {
font-size:28px
}

#humans-counter,#animals-counter,#lps-counter {
font-size:14px
}

#time-counter {
font-size:12px
}

.upgrade-btn,.game-btn {
font-size:14px;
padding:12px
}
}

#stats-grid {
display:grid;
grid-template-columns:repeat(auto-fill,minmax(200px,1fr));
gap:10px;
padding-bottom:70px
}

.stat-item {
background:#ffffff0d;
border:1px solid #ffffff1a;
border-radius:15px;
padding:20px;
transition:transform .3s ease
}

.stat-item:hover {
transform:translateY(-2px);
background:#ffffff14
}

#ad-container {
width:100%;
max-width:728px;
margin:20px auto;
text-align:center;
background-color:#4a4a8ae6;
border-radius:10px;
padding:10px
}

#vignette-overlay {
position:fixed;
top:0;
left:0;
width:100%;
height:100%;
pointer-events:none;
z-index:9999;
opacity:0;
transition:opacity .3s ease;
background:radial-gradient(circle,transparent 50%,#000c 150%)
}

#vignette-overlay.active {
opacity:1
}

.loading-overlay {
position:fixed;
top:0;
left:0;
width:100%;
height:100%;
background:#000c;
display:flex;
flex-direction:column;
justify-content:center;
align-items:center;
color:#fff;
font-size:24px;
z-index:1001
}

.loading-spinner {
border:8px solid #ffffff1a;
border-top:8px solid #fff;
border-radius:50%;
width:50px;
height:50px;
animation:spin 1s linear infinite
}

.loading-text {
margin-top:10px
}

@keyframes spin {
0% {
transform:rotate(0deg)
}

100% {
transform:rotate(360deg)
}
}

@keyframes pulse {
0% {
transform:scale(1)
}

50% {
transform:scale(1.05)
}

100% {
transform:scale(1)
}
}
  </style>
</head>
<body>
<div id="mobile-nav">
  <button class="nav-btn active" data-tab="home">Home</button>
  <button class="nav-btn" data-tab="creativity">Creativity</button>
  <button class="nav-btn" data-tab="stats">Stats</button>
  <button class="nav-btn" data-tab="options">Options</button>
</div>
<div id="tab-content">
  <div id="home-tab" class="tab-pane active">
    <div id="game-container">
      <div id="hud">
        <div id="life-counter">Life: 0</div>
        <div id="humans-counter">Humans: 0</div>
        <div id="animals-counter">Animals: 0</div>
        <div id="lps-counter">Life per second: 0</div>
        <div id="time-counter">Year 0, Day 0, 00:00:00</div>
      </div>
    </div>
    </div>
  </div>
  <div id="creativity-tab" class="tab-pane">
    <div id="upgrades">
      <h2>Upgrades</h2>
      <div id="upgrade-grid">
        <button class="upgrade-btn" id="planet-upgrade">Upgrade Planet (Cost: 10 Life)</button>
        <button class="upgrade-btn" id="human-upgrade">Create Humans (Cost: 100 Life)</button>
        <button class="upgrade-btn" id="animal-upgrade">Create Animals (Cost: 50 Life)</button>
        <button class="upgrade-btn" id="click-upgrade">Upgrade Click (Cost: 50 Life)</button>
        <button class="upgrade-btn" id="education-upgrade">Education System (Cost: 200 Life)</button>
        <button class="upgrade-btn" id="technology-upgrade">Technological Advancement (Cost: 500 Life)</button>
        <button class="upgrade-btn" id="ecosystem-upgrade">Enhance Ecosystem (Cost: 150 Life)</button>
        <button class="upgrade-btn" id="biodiversity-upgrade">Increase Biodiversity (Cost: 300 Life)</button>
        <button class="upgrade-btn" id="agriculture-upgrade">Develop Agriculture (Cost: 250 Life)</button>
        <button class="upgrade-btn" id="conservation-upgrade">Wildlife Conservation (Cost: 350 Life)</button>
        <button class="upgrade-btn" id="critical-upgrade">Critical Chance (Cost: 150 Life)</button>
      </div>
    </div>
  </div>
  <div id="stats-tab" class="tab-pane">
    <div id="stats-container">
      <h2>Game Statistics</h2>
      <div id="stats-grid">
        <div class="stat-item">
          <span class="stat-label" id="total-life-label">Total Life Produced:</span>
          <span id="total-life-stat">0</span>
        </div>
        <div class="stat-item">
          <span class="stat-label" id="total-clicks-label">Total Clicks:</span>
          <span id="total-clicks-stat">0</span>
        </div>
        <div class="stat-item">
          <span class="stat-label" id="planets-produced-label">Planets Produced:</span>
          <span id="planets-produced-stat">0</span>
        </div>
        <div class="stat-item">
          <span class="stat-label" id="humans-created-label">Humans Created:</span>
          <span id="humans-created-stat">0</span>
        </div>
        <div class="stat-item">
          <span class="stat-label" id="animals-created-label">Animals Created:</span>
          <span id="animals-created-stat">0</span>
        </div>
        <div class="stat-item">
          <span class="stat-label" id="time-played-label">Time Played:</span>
          <span id="time-played-stat">0 days, 00:00:00</span>
        </div>
        <div class="stat-item">
          <span class="stat-label" id="crit-chance-label">Critical Chance:</span>
          <span id="crit-chance-stat">5%</span>
        </div>
        <div class="stat-item">
          <span class="stat-label" id="crit-damage-label">Critical Damage:</span>
          <span id="crit-damage-stat">2x</span>
        </div>
        <div class="stat-item">
          <span class="stat-label" id="crit-hits-label">Critical Hits:</span>
          <span id="crit-hits-stat">0</span>
        </div>
      </div>
    </div>
  </div>
  <div id="options-tab" class="tab-pane">
    <div id="sidebar">
      <h2>Game Options</h2>
      <div id="game-controls">
        <button class="game-btn" id="save-game">Save Game</button>
        <button class="game-btn" id="reset-game">Reset Game</button>
        <button class="game-btn" id="toggle-sound" style="display: none;">Sound Effects: On</button>
        <button class="game-btn" id="toggle-music" style="display: none;">Music: On</button>
        <button class="game-btn" id="toggle-short-notation" style="display: none;">Short Numbers: On</button>
        <button class="game-btn" id="toggle-sharpness" style="display: none;">Galaxy Sharpness: Off</button>
        <button class="game-btn" id="toggle-closeup" style="display: none;">Planet Close-up: On</button>
        <button class="game-btn" id="toggle-fast-notes" style="display: none;">Fast Notes: On</button>
        <button class="game-btn" id="toggle-vignette" style="display: none;">Vignette Effect: Off</button>
      </div>
      <div id="game-info">
        <p id="zoom-info">Zoom: Z (in) / O (out)</p>
        <p id="human-activity">Human Activity: Idle</p>
      </div>
    </div>
  </div>
</div>
<div id="vignette-overlay"></div>
  <script>
// Initialize Greenworks (Steam API) 
if (typeof greenworks === 'undefined') {
  console.error('Greenworks not found! Make sure greenworks.js is properly included.');
} else {
  // Check if Steam is running and initialized
  if (greenworks.init()) {
    console.log('Steam API initialized successfully!');
    
    // Cloud save functions  
    const cloudSave = {
      // Save game data to Steam Cloud
      saveToCloud: function(gameData) {
        try {
          const saveData = JSON.stringify(gameData);
          const fileName = 'earthclicker_save.json';
          
          greenworks.saveTextToFile(fileName, saveData, (success) => {
            if (success) {
              console.log('Game saved to Steam Cloud successfully!');
            } else {
              console.error('Failed to save game to Steam Cloud');
            }
          }, (error) => {
            console.error('Error saving to Steam Cloud:', error); 
          });
        } catch (error) {
          console.error('Error preparing save data:', error);
        }
      },

      // Load game data from Steam Cloud
      loadFromCloud: function(callback) {
        try {
          const fileName = 'earthclicker_save.json';
          
          greenworks.readTextFromFile(fileName, (saveData) => {
            try {
              const gameData = JSON.parse(saveData);
              console.log('Game loaded from Steam Cloud successfully!');
              callback(gameData);
            } catch (error) {
              console.error('Error parsing save data:', error);
              callback(null);
            }
          }, (error) => {
            console.error('Error loading from Steam Cloud:', error);
            callback(null);
          });
        } catch (error) {
          console.error('Error reading save file:', error);
          callback(null); 
        }
      },

      // Delete cloud save
      deleteCloudSave: function(callback) {
        try {
          const fileName = 'earthclicker_save.json';
          
          greenworks.deleteFile(fileName, (success) => {
            if (success) {
              console.log('Cloud save deleted successfully!');
              callback(true);
            } else {
              console.error('Failed to delete cloud save');
              callback(false);
            }
          });
        } catch (error) {
          console.error('Error deleting cloud save:', error);
          callback(false);
        }
      }
    };

    // Modify existing save/load functions to use Steam Cloud
    const originalSaveGame = saveGame;
    saveGame = function() {
      // First save locally
      originalSaveGame();
      
      // Then save to Steam Cloud
      const gameState = {
        life,
        humans,
        animals, 
        planetsProduced,
        lifePerSecond,
        lifePerClick,
        planetUpgradeCost,
        humanUpgradeCost,
        animalUpgradeCost,
        clickUpgradeCost,
        educationLevel,
        technologyLevel,
        ecosystemLevel,
        biodiversityLevel,
        educationUpgradeCost,
        technologyUpgradeCost,
        ecosystemUpgradeCost, 
        biodiversityUpgradeCost,
        agricultureUpgradeCost,
        conservationUpgradeCost,
        totalLifeProduced,
        totalClicks,
        humansCreated,
        animalsCreated,
        gameSeconds,
        gameDays,
        gameYears,
        isSoundEnabled,
        isMusicEnabled,
        isShortNotationOn: document.getElementById('toggle-short-notation').textContent === 'Short Numbers: On',
        isSharpnessEnabled,
        isCloseupEnabled,
        isFastNotesEnabled,
        isVignetteEnabled,
        criticalChance,
        criticalDamage,
        criticalHits,
        criticalUpgradeCost,
      };
      
      cloudSave.saveToCloud(gameState);
    };

    const originalLoadGame = loadGame;
    loadGame = function() {
      // First try to load from Steam Cloud
      cloudSave.loadFromCloud((cloudData) => {
        if (cloudData) {
          // Use cloud data
          Object.assign(window, cloudData);
          updateCounters();
          updateStats();
          updateAllUpgradeButtonTexts();
          
          // Update UI elements
          document.getElementById('toggle-vignette').textContent = `Vignette Effect: ${isVignetteEnabled ? 'On' : 'Off'}`;
          document.getElementById('vignette-overlay').classList.toggle('active', isVignetteEnabled);
          document.getElementById('toggle-closeup').textContent = `Planet Close-up: ${isCloseupEnabled ? 'On' : 'Off'}`;
          document.getElementById('toggle-sound').textContent = `Sound Effects: ${isSoundEnabled ? 'On' : 'Off'}`;
          document.getElementById('toggle-music').textContent = `Music: ${isMusicEnabled ? 'On' : 'Off'}`;
          document.getElementById('toggle-sharpness').textContent = `Galaxy Sharpness: ${isSharpnessEnabled ? 'On' : 'Off'}`;
          document.getElementById('toggle-fast-notes').textContent = `Fast Notes: ${isFastNotesEnabled ? 'On' : 'Off'}`;
          
          updateCameraPosition();
          updateSharpness();
        } else {
          // Fall back to local storage
          originalLoadGame();
        }
      });
    };

    // Handle cloud sync button display
    document.getElementById('save-game').style.display = 'block';
    document.getElementById('save-game').textContent = 'Sync with Steam Cloud';
    document.getElementById('save-game').onclick = saveGame;

    // Handle game reset
    const originalResetGame = resetGame;
    resetGame = function() {
      if (confirm('Are you sure you want to reset the game? All progress will be lost from both local storage and Steam Cloud.')) {
        cloudSave.deleteCloudSave(() => {
          localStorage.removeItem('planetIdleGame');
          location.reload();
        });
      }
    };

  } else {
    console.error('Failed to initialize Steam API');
  }
}
</script>
</body>
</html>
